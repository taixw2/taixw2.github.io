# 隐式类型转换

## toString 、 String 、 valueOf
- toString 对象上的一个方法，负责处理这个方法`this`的数据类型转换成字符串的操作 (除undefined、null外所有数据类型均有这个方法)
- String 一个全局函数，也是字符串的构造函数，负责处理非字符串到字符串的类型转换 (包括undefined、null)
- valueOf 获取对象的原始（primitive）值 `(new Number(123)).valueOf()`

## ToString *类似String()，浏览器内部转换*
- 两个操作数以 + 连接，其中一个是字符串或者对象，则会触发隐式转换
  - 非字符串的基本数据类型(undefined、null、number、boolean)一方强制转换  
  - 引用数据类型的转换
    - 调用valueOf，如果返回的是基本数据类型，则强制转换，如果返回的是引用数据类型，则再次调用该数据的toString方法

> tips : {} + [] : 前面的{}会被解析称代码块而不是对象， 所以就相当于 `+[]` ;

```javascript
//对非字符串的基本数据强制转换
true + "1"  // ==> true1
1 + "1" //==> 11
// 引用数据类型 ,获取原始值[[PrimitiveValue]]再转换成字符串
[123] + "string" //==>123string
({}) + "string" // ==> [object Object]string
// 代码块
{} + []   // ==> +[] 一元运算
function(){} + [] // ==> 同上
```

## ToNumber *类似Number()的转换方法，浏览器内部转换*
- 一元操作符/位操作符 (加+，减1，按位非~，按位与&，按位或|，按位异或^，左位移<<，右位移>>)
  - 基本数据类型直接强制转换
    - Boolean 转换成 0/1
    - String/undefined 转换成 对应数字或者NaN
    - null 转换成 0
  - 操作引用数据类型首先进行 **ToString** 操作，然后再执行强制转换
- 减(a-b)、乘(a*b)、除(a/b)、异或(a^b)
  - 对操作数使用 **一元操作符/位操作符** 的规则进行转换
- 比较操作符
  - 两个操作数均不是字符串且其中一个类型是Number则对其使用 **一元操作符/位操作符** 的规则进行转换后再比较 *比较两个字符串使用对应的字符编码进行比较*
- 等性操作符 （==、!=） *操作数类型不一致*
  - 如果两个操作数是基本数据类型 *(除`undefined、null`)*, 且操作数类型不一致时 **undefined 和 null 不会转换成其它类型**
    - 对操作数使用  **一元操作符/位操作符** 的基本数据类型转换规则进行转换
  - 如果操作数中包含引用数据类型，则对引用数据使用 **一元操作符/位操作符** 的引用数据类型的转换规则进行转换
```javascript
//一元操作符/位操作符号
+true   //==> 1
+"abc"  //==> NaN
+undefined  //==> NaN
+"123"  //==> 123
+null   //==> 0
+{}   //==>null
+[]   //==>0
+"" //==>0
// 比较两个值
1 < "100"   // ==> true
100 > ["10"]  // ==> true     ["10"] ===> "10" ===> 10
100 > {}   // ==> false     {} 转换称 NaN
1 > false   // == true
//  以下情况均会隐式转换称Number类型
1 == [1]    //==>true
1 == true   //==>true
"1" == true //==>true
1 == {}
//以下情况不会
0 == null   //==> false
0 == undefined  //==> false
```

## ToBoolean
所有用于执行条件判断的非boolean值(如果是表达式则计算之后再转换)都会被强制转换成boolean值
```javascript
if ("abc") {} // 条件判断表达式将被隐式转换成boolean
for (var a = 1; a ;a--) { }     //第二个参数将隐式转换成boolean
//隐式转换成boolean
while ("abc") { }   
123 ? "123" : "0"   //三元运算中的条件判断表达式将被隐式转换成boolean
```
